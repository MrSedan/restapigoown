version: "3"
services:
    db:
        container_name: psql
        restart: always
        image: psql
        build:
            context: ./db
        volumes:
            - ./db/data/:/var/lib/postgresql/data
        environment:
            POSTGRES_USER: postgres
            POSTGRES_PASSWORD: postgres  # To be moved to environment file
            POSTGRES_DATABASE: myrest
            SSLMODE: disable
        expose:
            - 5432
        ports:
            - 5432:5432
        networks:
            - psql-pgql
    frontend:
        image: mrsedan/vue-socset
        restart: always
        build: ./frontend
        volumes: 
            - ./frontend:/frontend
        expose: 
            - 80
            - 443
        ports: 
            - 80:80
            - 443:443
        networks: 
            - vue-front
    go-docker-image:
        image: mrsedan/go-rest-api
        restart: always
        build: ./backend
        ports: 
            - '8080:8080'
        volumes: 
            - ./backend:/app
        depends_on: 
            - db
    
networks:
    vue-front:
    psql-pgql: